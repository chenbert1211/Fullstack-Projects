{"filter":false,"title":"zillow_homes_for_sale.py","tooltip":"/zillow_homes_for_sale/zillow_homes_for_sale.py","undoManager":{"mark":-1,"position":-1,"stack":[[{"start":{"row":0,"column":0},"end":{"row":85,"column":0},"action":"remove","lines":["#!/usr/bin/env python","# coding: utf-8","","# # Zillow.com Web Scraper written in Python to extract real estate & homes for sale listings based on a city name","","# In[3]:","","","from lxml import html","import requests","import unicodecsv as csv","import numpy as np","import pandas as pd","","","# In[5]:","","","def parse(city,filter=None):   ","","    if filter==\"newest\":","        url = \"https://www.zillow.com/{0}/days_sort/\".format(city)","    elif filter == \"cheapest\":","        url = \"https://www.zillow.com/{0}/pricea_sort/\".format(city)","    else:","        url = \"https://www.zillow.com/{0}/\".format(city)","        ","    headers= {","            'accept':'text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8',","            'accept-encoding':'gzip, deflate, sdch, br',","            'accept-language':'en-GB,en;q=0.8,en-US;q=0.6,ml;q=0.4',","            'cache-control':'max-age=0',","            'upgrade-insecure-requests':'1',","            'user-agent':'Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/56.0.2924.87 Safari/537.36'","    }","        ","    response = requests.get(url,headers=headers)","    raw_t = response.text","    df = pd.DataFrame(columns=['price', 'postal_address', 'number_of_bedrooms', 'living_area'])","    ","    i = 2","    ","    while True:","        ","        test_page = raw_t.find('\"Page '+ str(i) + '\"')","        ","        while raw_t.find('\"price\":\"C$') > 0:       ","            start_address = raw_t.find('\"price\":\"C$') + 11","            raw_t = raw_t[start_address:]","            end_address = raw_t.find('\",\"unformattedPrice\"')","            price = raw_t[:end_address]","            print(price)","","            start_address = raw_t.find('\"address\":\"') + 11","            raw_t = raw_t[start_address:]","            end_address = raw_t.find('\",\"addressStreet\":\"')","            postal_address = raw_t[:end_address] ","            print(postal_address)","","            start_address = raw_t.find('\"bedrooms\":') + 11","            raw_t = raw_t[start_address:]","            end_address = raw_t.find(',\"livingArea\":')","            bedrooms = raw_t[:end_address] ","            print(bedrooms)","","            start_address = raw_t.find('\"livingArea\":') + 13","            raw_t = raw_t[start_address:]","            end_address = raw_t.find(',\"homeType\":')","            livingArea = raw_t[:end_address] ","            print(livingArea)","            ","            df.loc[df.shape[0]] = [price, postal_address, bedrooms, livingArea]","            ","       ","        if test_page == -1:","            break","        print(url + str(i) + '_p/')","        response = requests.get(url + str(i) + '_p/',headers=headers)","        raw_t = response.text","        i = i+1","    ","    return df","","    df.to_csv(\"houses_for_sale.csv\",index=False)    ","",""],"id":2},{"start":{"row":0,"column":0},"end":{"row":15,"column":3},"action":"insert","lines":["fetch(\"https://www.zillow.com/search/GetSearchPageState.htm?searchQueryState=%7B%22pagination%22%3A%7B%22currentPage%22%3A2%7D%2C%22usersSearchTerm%22%3A%22NY%22%2C%22mapBounds%22%3A%7B%22west%22%3A-82.19704245312501%2C%22east%22%3A-69.34303854687501%2C%22south%22%3A39.47103937369902%2C%22north%22%3A45.93669427873671%7D%2C%22mapZoom%22%3A7%2C%22regionSelection%22%3A%5B%7B%22regionId%22%3A43%2C%22regionType%22%3A2%7D%5D%2C%22isMapVisible%22%3Atrue%2C%22filterState%22%3A%7B%22isAllHomes%22%3A%7B%22value%22%3Atrue%7D%2C%22sortSelection%22%3A%7B%22value%22%3A%22globalrelevanceex%22%7D%7D%2C%22isListVisible%22%3Atrue%7D&wants={%22cat1%22:[%22listResults%22,%22mapResults%22],%22cat2%22:[%22total%22],%22regionResults%22:[%22total%22]}&requestId=2\", {","  \"headers\": {","    \"accept\": \"*/*\",","    \"accept-language\": \"en-US,en;q=0.9\",","    \"sec-ch-ua\": \"\\\"Chromium\\\";v=\\\"104\\\", \\\" Not A;Brand\\\";v=\\\"99\\\", \\\"Google Chrome\\\";v=\\\"104\\\"\",","    \"sec-ch-ua-mobile\": \"?0\",","    \"sec-ch-ua-platform\": \"\\\"Windows\\\"\",","    \"sec-fetch-dest\": \"empty\",","    \"sec-fetch-mode\": \"cors\",","    \"sec-fetch-site\": \"same-origin\",","    \"cookie\": \"zguid=24|%24c4293ff0-e5f7-42ff-a3b8-7e788ec48cd3; zgsession=1|48e9a8b0-2f10-491d-a0f9-1d74c18e6d73; _ga=GA1.2.1728330296.1660850416; _gid=GA1.2.640005336.1660850416; zjs_user_id=null; zg_anonymous_id=%22c9d4820b-1fd1-470d-908e-e8766faba766%22; zjs_anonymous_id=%22c4293ff0-e5f7-42ff-a3b8-7e788ec48cd3%22; _gcl_au=1.1.1442134203.1660850416; KruxPixel=true; DoubleClickSession=true; _cs_c=0; pxcts=c9935ace-1f2a-11ed-b7ae-445666474258; _pxvid=c9934e9d-1f2a-11ed-b7ae-445666474258; __pdst=bddf65e57eb745748204fc5f3192d2f6; _pin_unauth=dWlkPVpUUmpNREk0TlRZdE9HSmtNQzAwWWpabExXSXlPVEF0WldFMk1XUTNObVJtTURBeg; _clck=978byl|1|f44|0; utag_main=v_id:0182b26629970014774dfd87873c0506f001706700bd0$_sn:1$_se:1$_ss:1$_st:1660852216023$ses_id:1660850416023%3Bexp-session$_pn:1%3Bexp-session$dcsyncran:1%3Bexp-session$tdsyncran:1%3Bexp-session$dc_visit:1$dc_event:1%3Bexp-session$dc_region:us-east-1%3Bexp-session$ttd_uuid:0c0d2f46-4aeb-4cb6-877b-e23b9064b7f4%3Bexp-session; g_state={\\\"i_p\\\":1660857623728,\\\"i_l\\\":1}; KruxAddition=true; _hp2_id.1215457233=%7B%22userId%22%3A%224640487766901439%22%2C%22pageviewId%22%3A%221767574818758362%22%2C%22sessionId%22%3A%228395648167431798%22%2C%22identity%22%3Anull%2C%22trackerVersion%22%3A%224.0%22%7D; _cs_id=9e0f19dd-8c83-a69e-9736-4470fd0b825c.1660850416.1.1660850798.1660850416.1.1695014416461; JSESSIONID=558EF4C9C9782E8DCCF6FF2F0BB48601; search=6|1663446805544%7Cregion%3Dny%26rect%3D45.015865%252C-71.777491%252C40.477399%252C-79.76259%26disp%3Dmap%26mdm%3Dauto%26p%3D2%26fs%3D1%26fr%3D0%26mmm%3D1%26rs%3D0%26ah%3D0%09%0943%09%09%09%09%09%09; _pxff_bsco=1; _gat=1; _px3=3e1daaee76e3392956e280406138e492a8f6f93009fd994731e06d96a32a4059:yXnk9Vt5sSWnAAUG0+yrSwH72nhTQ1tZImOdgdQhlZCz/g9baI0hDV/b7W2Y+HR1yEWFLLBC3kIggTgrqlNWzw==:1000:N+jERS36XvCYRiHQR/GMhxG6W5sFskVN49phsGKOJosow2b54bZa0/4HaJynCXjFqwX7waqNZH8FayIDyEsJ8BsC5Vs6HehABZkEvOZ68CDxXU0WZcuy/Hu9OUBHSsSlADDxsLYhomQnBcbV6rwtpLXUNys/k+ubmKYEPc4wJkY8G0kPQ8IEGIPuTS5QwWGTAz2njt00dkY02Unquy6irQ==; AWSALB=Al4aSojfMrRhY8qTDpOP5LmhaNrwb4fp6A3XkVhDpSZvD3kJw+nERNx4oyMW+2tLkRXOSQj4CsU7h0zmhS7N71FBJaiLE9aZHi07cv8t5Ur44iWaXN+GAOzW1MkC; AWSALBCORS=Al4aSojfMrRhY8qTDpOP5LmhaNrwb4fp6A3XkVhDpSZvD3kJw+nERNx4oyMW+2tLkRXOSQj4CsU7h0zmhS7N71FBJaiLE9aZHi07cv8t5Ur44iWaXN+GAOzW1MkC; _uetsid=cab73c601f2a11ed84ef0fccf1d16aa3; _uetvid=cab768a01f2a11edb4d88179307541f8; _clsk=1oyw7pv|1660854808167|2|0|m.clarity.ms/collect\"","  },","  \"referrerPolicy\": \"unsafe-url\",","  \"body\": null,","  \"method\": \"GET\"","});"]}]]},"ace":{"folds":[],"scrolltop":0,"scrollleft":0,"selection":{"start":{"row":0,"column":0},"end":{"row":85,"column":0},"isBackwards":true},"options":{"guessTabSize":true,"useWrapMode":false,"wrapToView":true},"firstLineState":0},"timestamp":1660852793619,"hash":"9699b8ad157ea7362b2fb4ef8f32ad3afaf5c9c6"}